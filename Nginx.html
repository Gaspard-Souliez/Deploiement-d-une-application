<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Arthur KELLER, Gaspard SOULIEZ" />
  <title>Procédure l'installation de Postgres</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="css/style.css" />
  
  
  
  
  
  
  
  
  
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Procédure l'installation de Postgres</h1>
<p class="author">Arthur KELLER, Gaspard SOULIEZ</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#installation-de-synapse"
id="toc-installation-de-synapse"><span
class="toc-section-number">1</span> Installation de Synapse</a>
<ul>
<li><a href="#installation-du-paquet-sous-debian"
id="toc-installation-du-paquet-sous-debian"><span
class="toc-section-number">1.1</span> Installation du paquet sous
Debian</a></li>
<li><a href="#paramétrage-de-laccès-à-distance"
id="toc-paramétrage-de-laccès-à-distance"><span
class="toc-section-number">1.2</span> Paramétrage de l’accès à
distance</a></li>
<li><a
href="#paramétrage-spécifique-pour-une-instance-dans-un-réseau-privé"
id="toc-paramétrage-spécifique-pour-une-instance-dans-un-réseau-privé"><span
class="toc-section-number">1.3</span> Paramétrage spécifique pour une
instance dans un réseau privé</a></li>
<li><a href="#utilisation-dune-base-postgres"
id="toc-utilisation-dune-base-postgres"><span
class="toc-section-number">1.4</span> Utilisation d’une base
Postgres</a></li>
<li><a href="#création-dutilisateurs"
id="toc-création-dutilisateurs"><span
class="toc-section-number">1.5</span> Création d’utilisateurs</a></li>
<li><a href="#connexion-à-votre-serveur-matrix"
id="toc-connexion-à-votre-serveur-matrix"><span
class="toc-section-number">1.6</span> Connexion à votre serveur
Matrix</a></li>
<li><a href="#activation-de-lenregistrement-des-utilisateurs"
id="toc-activation-de-lenregistrement-des-utilisateurs"><span
class="toc-section-number">1.7</span> Activation de l’enregistrement des
utilisateurs</a></li>
<li><a href="#fichier-homeserver.yaml"
id="toc-fichier-homeserver.yaml"><span
class="toc-section-number">1.8</span> Fichier
<code>homeserver.yaml</code></a></li>
</ul></li>
</ul>
</nav>
<h1 data-number="1" id="installation-de-synapse"><span
class="header-section-number">1</span> Installation de Synapse</h1>
<p>Il est temps d’installer Synapse, l’implémentation de référence pour
un serveur Matrix.</p>
<h2 data-number="1.1" id="installation-du-paquet-sous-debian"><span
class="header-section-number">1.1</span> Installation du paquet sous
Debian</h2>
<p>Lors de l’installation, le gestionnaire de paquets vous demandera le
nom de votre instance. Vous devez indiquer
<code>machine-physique.iutinfo.fr:8008</code>. Assurez-vous de bien
spécifier le port <code>8008</code> et de remplacer
<code>machine-physique</code> par le nom de votre <strong>machine
physique</strong> (par exemple <code>ayou03</code>).</p>
<p>Pour télécharger Synapse, copiez-collez ce script :</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">user@matrix$</span> sudo apt install <span class="at">-y</span> lsb-release wget apt-transport-https</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">user@matrix$</span> sudo wget <span class="at">-O</span> /usr/share/keyrings/matrix-org-archive-keyring.gpg https://packages.matrix.org/debian/matrix-org-archive-keyring.gpg</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">user@matrix$</span> echo <span class="st">&quot;deb [signed-by=/usr/share/keyrings/matrix-org-archive-keyring.gpg] https://packages.matrix.org/debian/ </span><span class="va">$(</span><span class="ex">lsb_release</span> <span class="at">-cs</span><span class="va">)</span><span class="st"> main&quot;</span> <span class="kw">|</span> <span class="fu">sudo</span> tee /etc/apt/sources.list.d/matrix-org.list</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">user@matrix$</span> sudo apt update</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="ex">user@matrix$</span> sudo apt install matrix-synapse-py3</span></code></pre></div>
<h2 data-number="1.2" id="paramétrage-de-laccès-à-distance"><span
class="header-section-number">1.2</span> Paramétrage de l’accès à
distance</h2>
<p>Par défaut, Synapse n’écoute que sur l’interface de boucle locale.
Pour permettre l’accès depuis l’extérieur de la machine virtuelle, il
doit également écouter sur l’interface du réseau
<code>10.42.xx.yy/16</code>.</p>
<p>Modifiez le fichier <code>homeserver.yaml</code> :</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">user@matrix$</span> sudo nano /etc/matrix-synapse/homeserver.yaml</span></code></pre></div>
<p>Modifiez la ligne suivante :</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">bind_addresses:</span> [<span class="st">&#39;::1&#39;</span>, <span class="st">&#39;127.0.0.1&#39;</span>]</span></code></pre></div>
<p>À :</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">bind_addresses:</span> [<span class="st">&#39;::1&#39;</span>, <span class="st">&#39;127.0.0.1&#39;</span>, <span class="st">&#39;10.42.xx.yy&#39;</span>]</span></code></pre></div>
<p>N’oubliez pas de remplacer <code>xx.yy</code> par la bonne
valeur.</p>
<p>Ensuite, redémarrez votre serveur avec la commande :</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">user@matrix$</span> sudo systemctl restart matrix-synapse</span></code></pre></div>
<h2 data-number="1.3"
id="paramétrage-spécifique-pour-une-instance-dans-un-réseau-privé"><span
class="header-section-number">1.3</span> Paramétrage spécifique pour une
instance dans un réseau privé</h2>
<p>Notre installation diffère car le serveur n’est pas accessible depuis
internet. En production réelle, il serait accessible. Les paramètres par
défaut de Synapse considèrent que le serveur est accessible de
l’extérieur et qu’il ne cherche pas à contacter des éléments sur un
réseau privé. On va donc appliquer la documentation en affectant la
variable de configuration <code>trusted_key_servers</code> à
<code>[]</code>.</p>
<p>Modifiez les lignes du fichier <code>homeserver.yaml</code> :</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">trusted_key_servers:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">-</span> server_name: <span class="st">&quot;matrix.org&quot;</span></span></code></pre></div>
<p>À :</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">trusted_key_servers:</span> []</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#  - server_name: &quot;matrix.org&quot;</span></span></code></pre></div>
<p>Redémarrez votre serveur avec la commande :</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">user@matrix$</span> sudo systemctl restart matrix-synapse</span></code></pre></div>
<h2 data-number="1.4" id="utilisation-dune-base-postgres"><span
class="header-section-number">1.4</span> Utilisation d’une base
Postgres</h2>
<p>Synapse utilise par défaut une base de données au format fichier
<code>sqlite</code>, idéal pour les tests mais insuffisant en
production. Changeons la configuration pour utiliser une base
<code>postgres</code>.</p>
<p>Modifiez les lignes du fichier <code>homeserver.yaml</code> :</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">database:</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">name:</span> sqlite3</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="ex">args:</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="ex">database:</span> DATADIR/homeserver.db</span></code></pre></div>
<p>À :</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">database:</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="ex">name:</span> psycopg2</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="ex">args:</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="ex">user:</span> <span class="op">&lt;</span>Nom d<span class="st">&#39;utilisateur de votre base de données&gt;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="st">    password: &lt;Mot de passe de votre utilisateur&gt;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="st">    database: &lt;Nom de votre base de données&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="st">    host: localhost</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="st">    cp_min: 5</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="st">    cp_max: 10</span></span></code></pre></div>
<p>Attention : lors de la séance précédente, une base de données matrix
a été créée avec des options par défaut incompatibles avec Synapse.
Changez la base de données avec ces commandes :</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">user@matrix$</span> sudo su <span class="at">-l</span> postgres</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="ex">postgres@matrix</span> dropdb <span class="op">&lt;</span>Nom de votre base de données<span class="op">&gt;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="ex">postgres@matrix:</span> createdb <span class="at">--encoding</span><span class="op">=</span>UTF8 <span class="at">--locale</span><span class="op">=</span>C <span class="at">--template</span><span class="op">=</span>template0 <span class="at">--owner</span><span class="op">=</span>matrix <span class="op">&lt;</span>Nom de votre base de données<span class="op">&gt;</span></span></code></pre></div>
<p>Redémarrez ensuite votre serveur :</p>
<div class="sourceCode" id="cb12"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="ex">user@matrix$</span> sudo systemctl restart matrix-synapse</span></code></pre></div>
<h2 data-number="1.5" id="création-dutilisateurs"><span
class="header-section-number">1.5</span> Création d’utilisateurs</h2>
<p>Pour créer un utilisateur, utilisez le script
<code>register_new_matrix_user</code> installé avec Synapse. Avant cela,
ajoutez une ligne au fichier <code>homeserver.yaml</code> :</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="ex">registration_shared_secret:</span> <span class="op">&lt;</span>Nom de la clé<span class="op">&gt;</span></span></code></pre></div>
<p>Redémarrez votre serveur avec la commande :</p>
<div class="sourceCode" id="cb14"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="ex">user@matrix$</span> sudo systemctl restart matrix-synapse</span></code></pre></div>
<p>Maintenant, créez un utilisateur avec la commande suivante, suivez
les instructions :</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="ex">user@matrix$</span> sudo register_new_matrix_user <span class="at">-k</span> <span class="op">&lt;</span>La clé que vous avez mise dans votre fichier de configuration<span class="op">&gt;</span></span></code></pre></div>
<h2 data-number="1.6" id="connexion-à-votre-serveur-matrix"><span
class="header-section-number">1.6</span> Connexion à votre serveur
Matrix</h2>
<p>Pour vous connecter à votre serveur, un client Element web a été
déployé pour vous à l’adresse <a
href="http://tp.iutinfo.fr:8888/">http://tp.iutinfo.fr:8888/</a> mais
avant cela, il va falloir quelque petite modification de votre commande
ssh. Pour ce faire, taper ces commandes :</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">user@phys$</span> nano .shh/config</span></code></pre></div>
<p>Normalement celui ci devrait etre comme ceci :</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="ex">Host</span> virt</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Hostname</span> dattier.iutinfo.fr</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ForwardAgent</span> yes</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="ex">Host</span> vmjump</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Hostname</span> 10.42.111.1</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="ex">Proxyjump</span> virt</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="ex">User</span> user</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="ex">LocalForward</span> 0.0.0.0:9090 localhost:80</span></code></pre></div>
<p>Si ce n’es pas, je vous invite à retrouner sur <a href="./ssh.md">la
procédure suivante</a>. Ensuite veuillez rajouter cette ligne pour le
<code>Host vmjump</code></p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">LocalForward</span> 0.0.0.0:8008 localhost:8008</span></code></pre></div>
<p>Une fois cette ligne rajouter, vous êtes prets à utiliser votre
serveur correctement à partir de votre machine physique</p>
<p>Utilisez ce client dans un navigateur de la machine physique et
connectez-vous à votre serveur. Attention, par défaut, le client veut se
connecter au</p>
<p>serveur <code>matrix.org</code>.</p>
<p>Ajoutez des captures d’écran pour illustrer ces exemples.</p>
<p>Cette étape doit être effectuée pour les deux utilisateurs (sur deux
machines physiques différentes).</p>
<p>Créez un salon avec un utilisateur et invitez l’autre utilisateur
dans le salon.</p>
<h2 data-number="1.7"
id="activation-de-lenregistrement-des-utilisateurs"><span
class="header-section-number">1.7</span> Activation de l’enregistrement
des utilisateurs</h2>
<p>Pour permettre l’enregistrement de nouveaux utilisateurs, modifiez le
fichier <code>homeserver.yaml</code> en ajoutant la ligne suivante :</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="ex">enable_registration:</span> true</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="ex">enable_registration_without_verification:</span> true</span></code></pre></div>
<h2 data-number="1.8" id="fichier-homeserver.yaml"><span
class="header-section-number">1.8</span> Fichier
<code>homeserver.yaml</code></h2>
<p>À la fin de cette procédure, votre fichier devrait présenter la
configuration suivante :</p>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Configuration file for Synapse.</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a YAML file: see [1] for a quick introduction. Note in particular</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># that *indentation is important*: all the elements of a list or dictionary</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># should have the same indentation.</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># For more information on how to configure Synapse, including a complete accounting of</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co"># each option, go to docs/usage/configuration/config_documentation.md or</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="co"># https://matrix-org.github.io/synapse/latest/usage/configuration/config_documentation.html</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a><span class="co"># This is set in /etc/matrix-synapse/conf.d/server_name.yaml for Debian installations.</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="co"># server_name: &quot;SERVERNAME&quot;</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a><span class="ex">pid_file:</span> <span class="st">&quot;/var/run/matrix-synapse.pid&quot;</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="ex">listeners:</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="ex">-</span> port: 8008</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="ex">tls:</span> false</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="ex">type:</span> http</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="ex">x_forwarded:</span> true</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="ex">bind_addresses:</span> [<span class="st">&#39;::1&#39;</span>, <span class="st">&#39;127.0.0.1&#39;</span>, <span class="st">&#39;10.42.xx.yy&#39;</span>]</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="ex">resources:</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>      <span class="ex">-</span> names: [client, federation]</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>        <span class="ex">compress:</span> false</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a><span class="ex">database:</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  <span class="ex">name:</span> psycopg2</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>  <span class="ex">args:</span></span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="ex">user:</span> <span class="st">&#39;Utilisateur de votre base de données&#39;</span></span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    <span class="ex">password:</span> <span class="st">&#39;Le mot de passe de votre utilisateur&#39;</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>    <span class="ex">database:</span> <span class="st">&#39;Le nom de la base de donnée&#39;</span></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>    <span class="ex">host:</span> localhost</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>    <span class="ex">cp_min:</span> 5</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="ex">cp_max:</span> 10</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a><span class="ex">log_config:</span> <span class="st">&quot;/etc/matrix-synapse/log.yaml&quot;</span></span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a><span class="ex">media_store_path:</span> /var/lib/matrix-synapse/media</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a><span class="ex">signing_key_path:</span> <span class="st">&quot;/etc/matrix-synapse/homeserver.signing.key&quot;</span></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a><span class="ex">trusted_key_servers:</span> []</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a><span class="co">#  - server_name: &quot;matrix.org&quot;</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a><span class="ex">registration_shared_secret:</span> <span class="st">&#39;Nom de votre clé&#39;</span></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a><span class="ex">enable_registration:</span> true</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a><span class="ex">enable_registration_without_verification:</span> true</span></code></pre></div>
</body>
</html>
